(this["webpackJsonpcurrency-exchange"]=this["webpackJsonpcurrency-exchange"]||[]).push([[0],{28:function(e,n,t){e.exports=t(41)},39:function(e,n,t){},41:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t.n(r),c=t(12),o=t.n(c),u=t(10),i=(t(38),t(39),t(9)),s=t(4),l=t(3),d=t(8),p=t.n(d),f=t(7),g=function(e){var n=/^[0-9]+\.?[0-9]{0,2}/.exec(e);return null!==n?n[0]:""},b={},h="rate/RATE_FETCH_STARTED",v="rate/RATE_FETCH_SUCCEEDED",x="rate/RATE_FETCH_FAILED";var m=Object(f.a)((function(e){return e.rate}),(function(e){return e.exchange.selectedCurrency}),(function(e,n){return e[n.source]||{}})),y=Object(f.a)(m,(function(e){return e.exchange.selectedCurrency}),(function(e,n){return e[n.target]})),E={pockets:{EUR:{currency:"EUR",amount:"230"},USD:{currency:"USD",amount:"350"},GBP:{currency:"GBP",amount:"650"}},selectedCurrency:{source:"EUR",target:"GBP"},currentValue:{source:"",target:""},lastActiveInput:{source:!1,target:!1}},O=1e13-1,j="exchange/CHANGE_AMOUNT",C="exchange/EXCHANGE_CURRENCY",w="exchange/CHANGE_CURRENCY_PAIR",k="exchange/SWAP_CURRENCY_PAIR";var R=Object(f.a)((function(e){return e.exchange.selectedCurrency.source}),(function(e){return e.exchange.currentValue.source}),(function(e){return e.exchange.pockets}),(function(e,n,t){return parseFloat(n)>parseFloat(t[e].amount)})),F=Object(f.a)(R,(function(e){return e.exchange.currentValue.source}),(function(e,n){var t=parseFloat(n);return isNaN(t)||0===t||e})),I=Object(f.a)((function(e){return e.exchange.pockets}),(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(e)})),_=Object(f.a)(I,(function(e){return e.exchange.selectedCurrency}),(function(e,n){var t=n.source,r=n.target;return{source:e.filter((function(e){return e!==r})),target:e.filter((function(e){return e!==t}))}})),A=Object(f.a)(y,(function(e){return e.exchange.currentValue}),(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1?arguments[1]:void 0,t=n.source,r=n.target,a=parseFloat(t);return isNaN(a)||0===a?{source:"",target:""}:{source:p()(r).div(e).toFixed(2),target:p()(t).times(e).toFixed(2)}})),S=Object(i.b)({exchange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case w:var t=n.origin,r=n.currency;return Object(l.a)({},e,{selectedCurrency:Object(l.a)({},e.selectedCurrency,Object(s.a)({},t,r)),currentValue:{source:"",target:""}});case k:return Object(l.a)({},e,{selectedCurrency:{source:e.selectedCurrency.target,target:e.selectedCurrency.source},currentValue:{source:e.currentValue.target,target:e.currentValue.source},lastActiveInput:{source:e.lastActiveInput.target,target:e.lastActiveInput.source}});case j:var a,c,o=n.origin,u=n.amount,i=n.rate,d=void 0===i?1:i,f="source"===o?"target":"source",b=g(u),h="source"===o?O:p()(O).times(d),v=(a={},Object(s.a)(a,o,!0),Object(s.a)(a,f,!1),a);if(""===b)return Object(l.a)({},e,{lastActiveInput:v,currentValue:{source:"",target:""}});if(parseFloat(b)>h)return e;var x=2===b.split(".").length?b:p()(b),m="source"===o?p()(x).times(d).toFixed(2):p()(x).div(d).toFixed(2);return Object(l.a)({},e,{lastActiveInput:v,currentValue:(c={},Object(s.a)(c,o,x.toString()),Object(s.a)(c,f,m.toString()),c)});case C:var y,R=e.selectedCurrency.source,F=e.currentValue.source,I=e.selectedCurrency.target,_=e.currentValue.target;return Object(l.a)({},e,{pockets:Object(l.a)({},e.pockets,(y={},Object(s.a)(y,R,Object(l.a)({},e.pockets[R],{amount:p()(e.pockets[R].amount).minus(F).toString()})),Object(s.a)(y,I,Object(l.a)({},e.pockets[I],{amount:p()(e.pockets[I].amount).add(_).toString()})),y)),currentValue:{source:"",target:""}});default:return e}},rate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case h:var t=n.base;return Object(l.a)({},e,Object(s.a)({},t,Object(l.a)({},e[t],{isLoading:!0,hasError:!1})));case v:var r=n.rates;return Object(l.a)({},e,Object(s.a)({},r.base,Object(l.a)({},r.rates,{isLoading:!1,hasError:!1})));case x:var a=n.base;return Object(l.a)({},e,Object(s.a)({},a,Object(l.a)({},e[a],{isLoading:!1,hasError:!0})));default:return e}}}),V=t(1),D=t(2);function N(){var e=Object(V.a)(["\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n"]);return N=function(){return e},e}var T=D.a.div(N()),P="#f3f4f5",U="#475b6b",z="#0056b2",B="#eb008d";function H(){var e=Object(V.a)(["\n  max-width: 550px;\n  width: 100%;\n  height: 660px;\n  margin-top: 20px;\n  display: flex;\n  flex-direction: column;\n  border: 1px solid ",";\n  border-radius: 16px;\n  background-color: ",";\n  overflow: hidden;\n"]);return H=function(){return e},e}var L=D.a.div(H(),P,P),G=t(11),X=t.n(G),W=t(20),Y=t(21),J=t(24),M=t(22),$=t(26),q=t(25),K=function(e,n){var t;return X.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,X.a.awrap(fetch("".concat("https://api.exchangeratesapi.io/latest","?base=").concat(e,"&symbols=").concat(n.join(","))));case 3:return t=r.sent,r.abrupt("return",t.json());case 7:throw r.prev=7,r.t0=r.catch(0),new Error(r.t0);case 10:case"end":return r.stop()}}),null,null,[[0,7]])};function Q(){var e=Object(V.a)(["\n  font-size: 22px;\n  font-weight: 400;\n  margin-left: 10px;\n"]);return Q=function(){return e},e}function Z(){var e=Object(V.a)(["\n  border: 0;\n  background-color: transparent;\n  font-size: 28px;\n  cursor: pointer;\n"]);return Z=function(){return e},e}function ee(){var e=Object(V.a)(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: 0 12px;\n  background-color: #fff;\n"]);return ee=function(){return e},e}var ne=D.a.div(ee()),te=D.a.button(Z()),re=D.a.h1(Q()),ae=function(e){var n=e.onClose;return a.a.createElement(ne,null,a.a.createElement(te,{"aria-label":"Close currency exchange section","data-testid":"close-button",onClick:n},"\xd7"),a.a.createElement(re,null,"Exchange"))};function ce(){var e=Object(V.a)(["\n  background-color: ",";\n  color: #fff;\n  font-size: 14px;\n  padding: 12px;\n  width: calc(100% - 36px);\n  margin: 0 18px 20px;\n  border: 0;\n  border-radius: 22px;\n  font-weight: 500;\n  font-size: 16px;\n  cursor: pointer;\n  box-shadow: 0px 4px 8px 2px #eb008d52;\n  transition: background-color 250ms ease-in-out;\n\n  &:disabled {\n    opacity: 0.6;\n    cursor: not-allowed;\n\n    &:hover {\n      background-color: ",";\n    }\n  }\n  &:hover {\n    background-color: #cc097e;\n  }\n"]);return ce=function(){return e},e}var oe=D.a.button(ce(),B,B),ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=navigator.language;return Intl.NumberFormat(n,Object(l.a)({style:"currency"},e)).format};function ie(){var e=Object(V.a)(["\n  color: ",";\n  background-color: #fff;\n  border: 2px solid ",";\n  padding: 4px 16px;\n  border-radius: 12px;\n  font-size: 14px;\n"]);return ie=function(){return e},e}var se=D.a.div(ie(),z,P),le=function(e){var n=e.selectedCurrency,t=e.targetRate,r=ue({currency:n.source,minimumFractionDigits:0}),c=ue({currency:n.target,maximumFractionDigits:4});return a.a.createElement(se,{"data-testid":"exchange-rate"},a.a.createElement("span",{"data-testid":"source-currency-rate"},r(1))," = ",a.a.createElement("span",{"data-testid":"current-rate"},t?c(t):"..."))};function de(){var e=Object(V.a)(["\n  width: 32px;\n  height: 32px;\n  background-color: #fff;\n  border: 2px solid ",";\n  font-size: 14px;\n  border-radius: 100%;\n  color: ",";\n  text-align: center;\n  cursor: pointer;\n"]);return de=function(){return e},e}var pe=D.a.button(de(),P,z),fe=t(23),ge=t.n(fe);function be(){var e=Object(V.a)(["\n  & input {\n    border: 0;\n    font-size: 28px;\n    text-align: right;\n    background-color: transparent;\n\n    &::placeholder {\n      color: #8b959e;\n    }\n  }\n"]);return be=function(){return e},e}function he(){var e=Object(V.a)(["\n  font-size: 28px;\n  vertical-align: top;\n"]);return he=function(){return e},e}function ve(){var e=Object(V.a)(["\n  display: flex;\n  align-items: center;\n"]);return ve=function(){return e},e}function xe(){var e=Object(V.a)(["\n  color: ",";\n  font-size: 14px;\n  padding-top: 8px;\n  padding-left: 8px;\n"]);return xe=function(){return e},e}function me(){var e=Object(V.a)(["\n  background-color: transparent;\n  border: 0;\n  font-size: 24px;\n  cursor: pointer;\n"]);return me=function(){return e},e}function ye(){var e=Object(V.a)(["\n  min-width: 130px;\n"]);return ye=function(){return e},e}function Ee(){var e=Object(V.a)(["\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0 12px;\n  background-color: ",";\n  height: 120px;\n"]);return Ee=function(){return e},e}var Oe=D.a.div(Ee(),(function(e){return{source:"#fff",target:P}[e.origin]})),je=D.a.div(ye()),Ce=D.a.select(me()),we=D.a.div(xe(),(function(e){return e.lowBalance?"red":U})),ke=D.a.div(ve()),Re=D.a.span(he()),Fe=Object(D.a)(ge.a)(be()),Ie=Object(u.b)((function(e,n){var t=e.exchange,r=e.rate,a=n.origin,c=t.selectedCurrency[a];return{currency:c,realTimeValue:A({exchange:t,rate:r})[a],isActive:t.lastActiveInput[a],balance:t.pockets[c].amount,amount:t.currentValue[a],lowBalance:R({exchange:t}),rate:y({exchange:t,rate:r})}}),(function(e,n){return{onCurrencyChange:function(t){e(function(e,n){return{type:w,origin:e,currency:n}}(n.origin,t))},onAmountChange:function(t,r){e(function(e,n,t){return{type:j,origin:e,amount:n,rate:t}}(n.origin,t,r))}}}))((function(e){var n=e.origin,t=e.currency,r=e.balance,c=e.amount,o=e.rate,u=e.isActive,i=e.realTimeValue,s=e.lowBalance,l=e.supportedPockets,d=e.onCurrencyChange,p=e.onAmountChange;return a.a.createElement(Oe,{origin:n},a.a.createElement(je,null,a.a.createElement(Ce,{"data-testid":"".concat(n,"-currency-selector"),value:t,"aria-label":"source"===n?"Select source currency":"Select target currency",onChange:function(e){var n=e.target;return d(n.value)}},l.map((function(e){return a.a.createElement("option",{key:e},e)}))),a.a.createElement(we,{"data-testid":"".concat(n,"-balance"),lowBalance:"source"===n&&s},"Balance: ",ue({currency:t})(r))),a.a.createElement(ke,null,parseFloat(c)>0&&a.a.createElement(Re,null,"source"===n?"-":"+"),a.a.createElement(Fe,{"data-testid":"".concat(n,"-input"),type:"text",autoFocus:"source"===n,"aria-label":"source"===n?"Enter source amount":"Enter target amount",placeholder:"0",value:u?c:i,onChange:function(e){var n=e.target;return p(n.value,o)}})))}));function _e(){var e=Object(V.a)(["\n  padding: 12px;\n  background-color: #000;\n  color: #fff;\n  margin: 0 18px 20px;\n  border-radius: 4px;\n  text-align: center;\n"]);return _e=function(){return e},e}function Ae(){var e=Object(V.a)(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: space-between;\n  margin-top: -16px;\n  padding: 0 12px;\n"]);return Ae=function(){return e},e}function Se(){var e=Object(V.a)(["\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  flex-grow: 1;\n"]);return Se=function(){return e},e}var Ve=D.a.form(Se()),De=D.a.div(Ae()),Ne=D.a.div(_e()),Te=function(e){function n(e){var t;return Object(W.a)(this,n),(t=Object(J.a)(this,Object(M.a)(n).call(this,e))).scheduleRateFetcher=function(e){var n=t.props.supportedPockets.target;t.clearFetcherInstance(),t.updateRates(e,n),t.fetcherInstance=setInterval((function(){return t.updateRates(e,n)}),1e4)},t.updateRates=function(e,n){var r;return X.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t.props.fetchRate(e),a.prev=1,a.next=4,X.a.awrap(K(e,n));case 4:r=a.sent,t.props.fetchRateSuccess(r),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(1),t.props.fetchRateError(e);case 11:case"end":return a.stop()}}),null,null,[[1,8]])},t.handleVisibilityChange=function(e){e?t.scheduleRateFetcher(t.props.selectedCurrency.source):t.clearFetcherInstance()},t.clearFetcherInstance=function(){t.fetcherInstance&&(clearInterval(t.fetcherInstance),t.fetcherInstance=null)},t.closeSection=function(){alert("Closing section")},t.submitForm=function(e){t.props.exchangeCurrency(),e.preventDefault()},t.scheduleRateFetcher(t.props.selectedCurrency.source),t}return Object($.a)(n,e),Object(Y.a)(n,[{key:"componentDidUpdate",value:function(e){e.selectedCurrency.source!==this.props.selectedCurrency.source&&this.scheduleRateFetcher(this.props.selectedCurrency.source)}},{key:"componentWillUnmount",value:function(){this.clearFetcherInstance()}},{key:"render",value:function(){var e=this.props,n=e.selectedCurrency,t=e.targetRate,r=e.isExchangeDisabled,c=e.rateHasError,o=e.supportedPockets,u=e.swapPockets;return a.a.createElement(q.a,{onChange:this.handleVisibilityChange},a.a.createElement(a.a.Fragment,null,a.a.createElement(ae,{onClose:this.closeSection}),a.a.createElement(Ve,{onSubmit:this.submitForm},a.a.createElement("div",null,a.a.createElement(Ie,{origin:"source",supportedPockets:o.source}),a.a.createElement(De,null,a.a.createElement(pe,{type:"button","data-testid":"swap-button","aria-label":"Swap source and target currencies",onClick:u},"\u21c5"),a.a.createElement(le,{selectedCurrency:n,targetRate:t}),a.a.createElement("div",null)),a.a.createElement(Ie,{origin:"target",supportedPockets:o.target})),c&&a.a.createElement(Ne,{role:"alert","data-testid":"error-message"},"Fetching exchange rates failed"),!c&&a.a.createElement(oe,{type:"submit","data-testid":"exchange-button",disabled:r},"Exchange"))))}}]),n}(a.a.Component),Pe=Object(u.b)((function(e){return{pocketCurrencies:I(e),targetRate:y(e),supportedPockets:_(e),selectedCurrency:e.exchange.selectedCurrency,isExchangeDisabled:F(e),rateIsLoading:m(e).isLoading,rateHasError:m(e).hasError}}),(function(e){return{exchangeCurrency:function(){e({type:C})},swapPockets:function(){e({type:k})},fetchRate:function(n){e({type:h,base:n})},fetchRateSuccess:function(n){e(function(e){return{type:v,rates:e}}(n))},fetchRateError:function(n){e({type:x,base:n})}}}))(Te),Ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i.c)(S,e,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())}({}),ze=function(){return a.a.createElement(u.a,{store:Ue},a.a.createElement(T,null,a.a.createElement(L,null,a.a.createElement(Pe,null))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(a.a.createElement(ze,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[28,1,2]]]);
//# sourceMappingURL=main.78597c73.chunk.js.map